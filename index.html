function processTO(data) {
        const headerRow = data[0]; 
        const orgIdx = headerRow.indexOf("조직");
        const toIdx = headerRow.findIndex(h => h.includes("잔여 TO") || h.includes("잔여 T.O"));

        let labels = [];
        let values = [];
        let colors = [];
        let totalSum = 0; // 중복 합산을 방지한 진짜 합계

        for (let i = 1; i < data.length; i++) {
            let row = data[i];
            let orgName = row[orgIdx] ? row[orgIdx].trim() : "";
            let toValue = parseInt(row[toIdx]);

            if (orgName && !isNaN(toValue)) {
                labels.push(orgName);
                values.push(toValue);

                // 상위 조직(팀, 본부)인 경우에만 전체 합계에 더함
                if (orgName.includes('팀') || orgName.includes('본부')) {
                    totalSum += toValue;
                    colors.push('#E6221A'); // 상위 조직은 진한 빨강
                } else {
                    // 하위 셀인 경우 합계에서는 제외하고 차트에만 표시
                    colors.push('#F37021'); // 하위 셀은 주황색
                }
            }
        }

        // 중복 없이 계산된 합계만 화면에 표시
        document.getElementById('totalTO').innerText = totalSum + "명";

        // 차트 생성 (시각적으로는 계층 구조를 그대로 보여줌)
        new Chart(document.getElementById('toChart'), {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: '잔여 T.O (단위: 명)',
                    data: values,
                    backgroundColor: colors,
                    borderRadius: 5
                }]
            },
            options: { 
                indexAxis: 'y',
                maintainAspectRatio: false,
                scales: { x: { beginAtZero: true } }
            }
        });
    }
